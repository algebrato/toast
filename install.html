<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installation &#8212; TOAST 2.2.0
 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2.0
',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="TOAST 2.2.0
 documentation" href="index.html" />
    <link rel="next" title="Pipelines" href="pipelines.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>TOAST 2.2.0
 documentation</span></a></h1>
        <h2 class="heading"><span>Installation</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="intro.html">Introduction</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="pipelines.html">Pipelines</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="installation">
<span id="install"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>TOAST is written in C++ and python3 and depends on several commonly available
packages.  It also has some optional functionality that is only enabled if
additional external libraries are available.</p>
<div class="section" id="compiled-dependencies">
<h2>Compiled Dependencies<a class="headerlink" href="#compiled-dependencies" title="Permalink to this headline">¶</a></h2>
<p>TOAST compilation requires a C++11 compatible compiler as well as a compatible
MPI C++ compiler wrapper.  You must also have an FFT library and both FFTW and
Intel&#8217;s MKL are supported by configure checks.  Additionally a BLAS/LAPACK
installation is required.</p>
<p>Several optional compiled dependencies will enable extra features in TOAST.
If the <a class="reference external" href="http://libelemental.org/">Elemental library</a> is found at configure
time then internal atmosphere simulation code will be enabled in the build.
If the <a class="reference external" href="https://github.com/hpc4cmb/libmadam">MADAM destriping mapmaker</a> is
available at runtime, then the python code will support calling that library.</p>
</div>
<div class="section" id="python-dependencies">
<h2>Python Dependencies<a class="headerlink" href="#python-dependencies" title="Permalink to this headline">¶</a></h2>
<p>You should have a reasonably new (&gt;= 3.4.0) version of python3.  We also require
several common scientific python packages:</p>
<blockquote>
<div><ul class="simple">
<li>numpy</li>
<li>scipy</li>
<li>matplotlib</li>
<li>pyephem</li>
<li>mpi4py (&gt;= 2.0.0)</li>
<li>healpy</li>
</ul>
</div></blockquote>
<p>For mpi4py, ensure that this package is compatible with the MPI C++ compiler
used during TOAST installation.  When installing healpy, you might encounter
difficulties if you are in a cross-compile situation.  In that case, I
recommend installing the <a class="reference external" href="https://github.com/tskisner/healpix-autotools">repackaged healpix here</a>.</p>
<p>There are obviously several ways to meet these python requirements.</p>
<div class="section" id="option-0">
<h3>Option #0<a class="headerlink" href="#option-0" title="Permalink to this headline">¶</a></h3>
<p>If you are using machines at NERSC, see <a class="reference internal" href="nersc.html#nersc"><span class="std std-ref">Using at NERSC</span></a>.</p>
</div>
<div class="section" id="option-1">
<h3>Option #1<a class="headerlink" href="#option-1" title="Permalink to this headline">¶</a></h3>
<p>If you are using a linux distribution which is fairly recent (e.g. the
latest Ubuntu version), then you can install all the dependencies with
the system package manager:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">fftw</span><span class="o">-</span><span class="n">dev</span> <span class="n">python3</span><span class="o">-</span><span class="n">scipy</span> \
   <span class="n">python3</span><span class="o">-</span><span class="n">matplotlib</span> <span class="n">python3</span><span class="o">-</span><span class="n">ephem</span> <span class="n">python3</span><span class="o">-</span><span class="n">healpy</span> \
   <span class="n">python3</span><span class="o">-</span><span class="n">mpi4py</span>
</pre></div>
</div>
<p>On OS X, you can also get the dependencies with macports.  However, on some
systems OpenMPI from macports is broken and MPICH should be installed
as the dependency for the mpi4py package.</p>
</div>
<div class="section" id="option-2">
<h3>Option #2<a class="headerlink" href="#option-2" title="Permalink to this headline">¶</a></h3>
<p>If your OS is old, you could use a virtualenv to install updated versions
of packages into an isolated location.  This is also useful if you want to
separate your packages from the system installed versions, or if you do not
have root access to the machine.  Make sure that you have python3 and the
corresponding python3-virtualenv packages installed on your system.  Also
make sure that you have some kind of MPI (OpenMPI or MPICH) installed with
your system package manager.  Then:</p>
<blockquote>
<div><ol class="arabic simple">
<li>create a virtualenv and activate it.</li>
<li>once inside the virtualenv, pip install the dependencies</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="option-3">
<h3>Option #3<a class="headerlink" href="#option-3" title="Permalink to this headline">¶</a></h3>
<p>Use Anaconda.  Download and install Miniconda or the full Anaconda distribution.
Make sure to install the Python3 version.  If you are starting from Miniconda,
install the dependencies that are available through conda:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="n">conda</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">scipy</span> <span class="n">matplotlib</span> <span class="n">mpi4py</span>
</pre></div>
</div>
<p>Then install healpy and pyephem with pip:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">healpy</span> <span class="n">pyephem</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-configure">
<h2>Using Configure<a class="headerlink" href="#using-configure" title="Permalink to this headline">¶</a></h2>
<p>TOAST uses autotools to configure, build, and install both the compiled code
and the python tools.  If you are running from a git checkout (instead of a
distribution tarball), then first do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="o">./</span><span class="n">autogen</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Now run configure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">install</span>
</pre></div>
</div>
<p>See the top-level &#8220;platforms&#8221; directory for other examples of running the
configure script.  Now build and install the tools:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>In order to use the installed tools, you must make sure that the installed
location has been added to the search paths for your shell.  For example,
the &#8220;&lt;prefix&gt;/bin&#8221; directory should be in your PATH and the python install
location &#8220;&lt;prefix&gt;/lib/pythonX.X/site-packages&#8221; should be in your PYTHONPATH.</p>
</div>
<div class="section" id="testing-the-installation">
<h2>Testing the Installation<a class="headerlink" href="#testing-the-installation" title="Permalink to this headline">¶</a></h2>
<p>After installation, you can run both the compiled and python unit tests.
These tests will create an output directory in your current working directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%&gt;</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;import toast; toast.test()&quot;</span>
</pre></div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="intro.html">Introduction</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="pipelines.html">Pipelines</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2017, Theodore Kisner, Reijo Keskitalo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>