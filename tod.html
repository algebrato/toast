<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Telescope TOD &#8212; TOAST 2.2.0
 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2.0
',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="TOAST 2.2.0
 documentation" href="index.html" />
    <link rel="next" title="Data Intervals" href="intervals.html" />
    <link rel="prev" title="Data Distribution" href="dist.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>TOAST 2.2.0
 documentation</span></a></h1>
        <h2 class="heading"><span>Telescope TOD</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="dist.html">Data Distribution</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="intervals.html">Data Intervals</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="telescope-tod">
<span id="tod"></span><h1>Telescope TOD<a class="headerlink" href="#telescope-tod" title="Permalink to this headline">¶</a></h1>
<p>The TOD base class represents the timestream information associated with a telescope.  The base class enforces a minimal set of methods for reading and writing detector data and flags, detector pointing, and timestamps.  The base class also provide methods for returning information about the data distribution, including which samples are local to a given process.</p>
<dl class="class">
<dt id="toast.tod.TOD">
<em class="property">class </em><code class="descclassname">toast.tod.</code><code class="descname">TOD</code><span class="sig-paren">(</span><em>mpicomm</em>, <em>detectors</em>, <em>samples</em>, <em>detindx=None</em>, <em>detranks=1</em>, <em>detbreaks=None</em>, <em>sampsizes=None</em>, <em>sampbreaks=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for an object that provides detector pointing and
timestreams for a single observation.</p>
<p>This class provides high-level functions that are common to all derived
classes.  It also defines the internal methods that should be overridden
by all derived classes.  These internal methods throw an exception if they
are called.  A TOD base class should never be directly instantiated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mpicomm</strong> (<em>mpi4py.MPI.Comm</em>) &#8211; the MPI communicator over which the data is distributed.</li>
<li><strong>detectors</strong> (<em>list</em>) &#8211; The list of detector names.</li>
<li><strong>samples</strong> (<em>int</em>) &#8211; The total number of samples.</li>
<li><strong>detindx</strong> (<em>dict</em>) &#8211; the detector indices for use in simulations.  Default is
{ x[0] : x[1] for x in zip(detectors, range(len(detectors))) }.</li>
<li><strong>detranks</strong> (<em>int</em>) &#8211; The dimension of the process grid in the detector
direction.  The MPI communicator size must be evenly divisible
by this number.</li>
<li><strong>detbreaks</strong> (<em>list</em>) &#8211; Optional list of hard breaks in the detector
distribution.</li>
<li><strong>sampsizes</strong> (<em>list</em>) &#8211; Optional list of sample chunk sizes which
cannot be split.</li>
<li><strong>sampbreaks</strong> (<em>list</em>) &#8211; Optional list of hard breaks in the sample
distribution.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="toast.tod.TOD.cache">
<code class="descname">cache</code><em class="property"> = None</em><a class="headerlink" href="#toast.tod.TOD.cache" title="Permalink to this definition">¶</a></dt>
<dd><p>The timestream data cache.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.detectors">
<code class="descname">detectors</code><a class="headerlink" href="#toast.tod.TOD.detectors" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(list)</em> &#8211; The total list of detectors.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.detindx">
<code class="descname">detindx</code><a class="headerlink" href="#toast.tod.TOD.detindx" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(dict)</em> &#8211; The detector indices.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.dist_chunks">
<code class="descname">dist_chunks</code><a class="headerlink" href="#toast.tod.TOD.dist_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(list)</em> &#8211; this is a list of 2-tuples, one for each column of the process
grid.  Each element of the list is the same as the information returned
by the &#8220;local_chunks&#8221; member for a given process column.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.dist_samples">
<code class="descname">dist_samples</code><a class="headerlink" href="#toast.tod.TOD.dist_samples" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(list)</em> &#8211; This is a list of 2-tuples, with one element per column
of the process grid.  Each tuple is the same information
returned by the &#8220;local_samples&#8221; member for the corresponding
process grid column rank.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.grid_ranks">
<code class="descname">grid_ranks</code><a class="headerlink" href="#toast.tod.TOD.grid_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(tuple)</em> &#8211; the ranks of this process in the (detector, sample)
directions.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.grid_size">
<code class="descname">grid_size</code><a class="headerlink" href="#toast.tod.TOD.grid_size" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(tuple)</em> &#8211; the dimensions of the process grid in (detector, sample)
directions.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.local_chunks">
<code class="descname">local_chunks</code><a class="headerlink" href="#toast.tod.TOD.local_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(2-tuple)</em> &#8211; the first element of the tuple is the index of the
first chunk assigned to this process (i.e. the index in the list
given by the &#8220;total_chunks&#8221; member).  The second element of the
tuple is the number of chunks assigned to this process.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.local_dets">
<code class="descname">local_dets</code><a class="headerlink" href="#toast.tod.TOD.local_dets" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(list)</em> &#8211; The detectors assigned to this process.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.local_samples">
<code class="descname">local_samples</code><a class="headerlink" href="#toast.tod.TOD.local_samples" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(2-tuple)</em> &#8211; The first element of the tuple is the first global
sample assigned to this process.  The second element of
the tuple is the number of samples assigned to this
process.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.mpicomm">
<code class="descname">mpicomm</code><a class="headerlink" href="#toast.tod.TOD.mpicomm" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(mpi4py.MPI.Comm)</em> &#8211; the communicator assigned to this TOD.</p>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>detector=None</em>, <em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read detector data.</p>
<p>This returns the timestream data for a single detector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>detector</strong> (<em>str</em>) &#8211; the name of the detector.</li>
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An array containing the data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read_common_flags">
<code class="descname">read_common_flags</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read_common_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read_common_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Read common flags.</p>
<p>This reads the common set of flags that should be applied to all
detectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a numpy array containing the flags.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read_flags">
<code class="descname">read_flags</code><span class="sig-paren">(</span><em>detector=None</em>, <em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Read detector flags.</p>
<p>This returns the detector-specific flags and the common flags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>detector</strong> (<em>str</em>) &#8211; the name of the detector.</li>
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>A 2-tuple of arrays, containing the detector flags and the common</dt>
<dd><p class="first last">flags.</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read_pntg">
<code class="descname">read_pntg</code><span class="sig-paren">(</span><em>detector=None</em>, <em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read_pntg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read_pntg" title="Permalink to this definition">¶</a></dt>
<dd><p>Read detector quaternion pointing.</p>
<p>This returns the pointing for a single detector in quaternions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>detector</strong> (<em>str</em>) &#8211; the name of the detector.</li>
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A 2D array of shape (n, 4)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read_position">
<code class="descname">read_position</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Read telescope position.</p>
<p>This reads the telescope position in solar system barycenter
coordinates (in Kilometers).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>a 2D numpy array containing the x,y,z coordinates at each</dt>
<dd><p class="first last">sample.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read_times">
<code class="descname">read_times</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Read timestamps.</p>
<p>This reads the common set of timestamps that apply to all detectors
in the TOD.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a numpy array containing the timestamps.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.read_velocity">
<code class="descname">read_velocity</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>n=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.read_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.read_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Read telescope velocity.</p>
<p>This reads the telescope velocity in solar system barycenter
coordinates (in Kilometers/s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; the number of samples to read.  If zero, read to end.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>a 2D numpy array containing the x,y,z velocity components</dt>
<dd><p class="first last">at each sample.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.total_chunks">
<code class="descname">total_chunks</code><a class="headerlink" href="#toast.tod.TOD.total_chunks" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(list)</em> &#8211; the full list of sample chunk sizes that were used in the
data distribution.</p>
</dd></dl>

<dl class="attribute">
<dt id="toast.tod.TOD.total_samples">
<code class="descname">total_samples</code><a class="headerlink" href="#toast.tod.TOD.total_samples" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(int)</em> &#8211; the total number of samples in this TOD.</p>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>detector=None</em>, <em>local_start=0</em>, <em>data=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write detector data.</p>
<p>This writes the detector data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>detector</strong> (<em>str</em>) &#8211; the name of the detector.</li>
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>data</strong> (<em>array</em>) &#8211; the data array.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write_common_flags">
<code class="descname">write_common_flags</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>flags=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write_common_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write_common_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Write common flags.</p>
<p>This writes the common set of flags that should be applied to all
detectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>flags</strong> (<em>array</em>) &#8211; array containing the flags to write.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write_det_flags">
<code class="descname">write_det_flags</code><span class="sig-paren">(</span><em>detector=None</em>, <em>local_start=0</em>, <em>flags=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write_det_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write_det_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Write detector flags.</p>
<p>This writes the detector-specific flags.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>detector</strong> (<em>str</em>) &#8211; the name of the detector.</li>
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>flags</strong> (<em>array</em>) &#8211; the detector flags.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write_pntg">
<code class="descname">write_pntg</code><span class="sig-paren">(</span><em>detector=None</em>, <em>local_start=0</em>, <em>data=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write_pntg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write_pntg" title="Permalink to this definition">¶</a></dt>
<dd><p>Write detector quaternion pointing.</p>
<p>This writes the quaternion pointing for a single detector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>detector</strong> (<em>str</em>) &#8211; the name of the detector.</li>
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>data</strong> (<em>array</em>) &#8211; 2D array of quaternions with shape[1] == 4.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write_position">
<code class="descname">write_position</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>pos=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Write telescope position.</p>
<p>This writes the telescope position in solar system barycenter
coordinates (in Kilometers).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>pos</strong> (<em>array</em>) &#8211; the 2D array of x,y,z coordinates at each sample.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write_times">
<code class="descname">write_times</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>stamps=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Write timestamps.</p>
<p>This writes the common set of timestamps that apply to all detectors
in the TOD.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>stamps</strong> (<em>array</em>) &#8211; the array of timestamps to write.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.tod.TOD.write_velocity">
<code class="descname">write_velocity</code><span class="sig-paren">(</span><em>local_start=0</em>, <em>vel=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/tod/tod.html#TOD.write_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.tod.TOD.write_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Write telescope velocity.</p>
<p>This writes the telescope velocity in solar system barycenter
coordinates (in Kilometers/s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local_start</strong> (<em>int</em>) &#8211; the sample offset relative to the first locally
assigned sample.</li>
<li><strong>vel</strong> (<em>array</em>) &#8211; the 2D array of x,y,z velocity components at each
sample.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>The base TOD class contains a member which is an instance of a Cache object.  This is similar to a dictionary of arrays, but by default the memory used in these arrays is allocated in C, rather than using the python memory pool.  This allows us to do aligned memory allocation and explicitly manage the lifetime of the memory.</p>
<dl class="class">
<dt id="toast.cache.Cache">
<em class="property">class </em><code class="descclassname">toast.cache.</code><code class="descname">Cache</code><span class="sig-paren">(</span><em>pymem=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Timestream data cache with explicit memory management.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pymem</strong> (<em>bool</em>) &#8211; if True, use python memory rather than external
allocations in C.  Only used for testing.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="toast.cache.Cache.add_alias">
<code class="descname">add_alias</code><span class="sig-paren">(</span><em>alias</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.add_alias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.add_alias" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an alias to a name that already exists in the cache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alias</strong> (<em>str</em>) &#8211; alias to create</li>
<li><strong>name</strong> (<em>str</em>) &#8211; an existing key in the cache</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.aliases">
<code class="descname">aliases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.aliases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.aliases" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of all the aliases to keys in the cache.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of aliases.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><em>pattern=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear one or more buffers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pattern</strong> (<em>str</em>) &#8211; a regular expression to match against the buffer
names when determining what should be cleared.  If None,
then all buffers are cleared.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>name</em>, <em>type</em>, <em>shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a named data buffer of the given type and shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) &#8211; the name to assign to the buffer.</li>
<li><strong>type</strong> (<em>numpy.dtype</em>) &#8211; one of the supported numpy types.</li>
<li><strong>shape</strong> (<em>tuple</em>) &#8211; a tuple containing the shape of the buffer.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.destroy">
<code class="descname">destroy</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.destroy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deallocate the specified buffer.</p>
<p>Only call this if all numpy arrays that reference the memory
are out of use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the name of the buffer or alias to destroy.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.exists">
<code class="descname">exists</code><span class="sig-paren">(</span><em>name</em>, <em>return_ref=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a buffer exists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the name of the buffer to search for.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a numpy array wrapping the raw data buffer or None if it does not exist.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all the keys in the cache.</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of key strings.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.put">
<code class="descname">put</code><span class="sig-paren">(</span><em>name</em>, <em>data</em>, <em>replace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.put"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a named data buffer to hold the provided data.
If replace is True, existing buffer of the same name is first
destroyed. If replace is True and the name is an alias, it is
promoted to a new data buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) &#8211; the name to assign to the buffer.</li>
<li><strong>data</strong> (<em>numpy.ndarray</em>) &#8211; Numpy array</li>
<li><strong>replace</strong> (<em>bool</em>) &#8211; Overwrite any existing keys</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.reference">
<code class="descname">reference</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array pointing to the buffer.</p>
<p>The returned array will wrap a pointer to the raw buffer, but will
not claim ownership.  When the numpy array is garbage collected, it
will NOT attempt to free the memory (you must manually use the
destroy method).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the name of the buffer to return.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a numpy array wrapping the raw data buffer.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="toast.cache.Cache.report">
<code class="descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/toast/cache.html#Cache.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#toast.cache.Cache.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Report memory usage.</p>
</dd></dl>

</dd></dl>

</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="dist.html">Data Distribution</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="intervals.html">Data Intervals</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2017, Theodore Kisner, Reijo Keskitalo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>